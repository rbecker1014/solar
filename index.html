<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#111827" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>Electricity & Solar — Mobile</title>
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>
  <style>
    :root { --safe-bottom: env(safe-area-inset-bottom, 0px); }
    body{
      min-height:100vh;
      padding-bottom:calc(76px + var(--safe-bottom));
      background:radial-gradient(circle at 20% 20%, rgba(56,189,248,0.12), transparent 55%),
                 radial-gradient(circle at 80% 0%, rgba(14,165,233,0.16), transparent 45%),
                 linear-gradient(160deg, #020617 0%, #0f172a 45%, #1e293b 100%);
      color:#f8fafc;
    }
    header .app-shell{
      background:linear-gradient(135deg, rgba(148,163,184,0.08) 0%, rgba(148,163,184,0.04) 60%, rgba(148,163,184,0.02) 100%);
      border:1px solid rgba(148,163,184,0.2);
      box-shadow:0 25px 50px -12px rgba(15,23,42,0.45);
      backdrop-filter:blur(18px);
    }
    main{
      max-width:64rem;
      margin-inline:auto;
    }
    .card{
      background:rgba(248,250,252,0.92);
      border-radius:1rem;
      box-shadow:0 16px 32px rgba(15,23,42,0.18);
      padding:1rem;
      border:1px solid rgba(15,23,42,0.08);
      color:#0f172a;
    }
    .kpi{font-size:1.6rem;font-weight:700;color:#0f172a}
    .kpi-label{font-size:.72rem;text-transform:uppercase;letter-spacing:.06em;color:#475569}
    .input{
      border:1px solid rgba(148,163,184,0.35);
      border-radius:.75rem;
      padding:.6rem .85rem;
      width:100%;
      background:rgba(255,255,255,0.92);
      color:#0f172a;
      transition:border-color .2s ease, box-shadow .2s ease, background .2s ease;
    }
    .input:focus{
      outline:none;
      border-color:#38bdf8;
      box-shadow:0 0 0 3px rgba(56,189,248,0.25);
      background:#fff;
    }
    .input-compact{padding:.35rem .5rem;font-size:.85rem;border-radius:.6rem}
    nav.app-nav{
      background:rgba(2,6,23,0.8);
      backdrop-filter:blur(18px);
      border:1px solid rgba(148,163,184,0.18);
      box-shadow:0 -10px 30px rgba(2,6,23,0.45);
    }
    .tab-icon{
      position:relative;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      font-size:.75rem;
      gap:2px;
      color:#94a3b8;
      transition:color .2s ease, transform .2s ease;
    }
    .tab-icon svg{width:20px;height:20px;stroke-width:2}
    .tab-icon::after{
      content:"";
      position:absolute;
      inset:auto 26% calc(-1 * var(--safe-bottom, 0px)) 26%;
      height:3px;
      border-radius:999px;
      background:linear-gradient(90deg, transparent, rgba(56,189,248,0.6), transparent);
      opacity:0;
      transform:translateY(6px);
      transition:opacity .2s ease, transform .2s ease;
    }
    .tab-icon:focus-visible{
      outline:none;
      box-shadow:0 0 0 3px rgba(56,189,248,0.35);
      border-radius:1rem;
    }
    .tab-icon.tab-active{
      color:#38bdf8;
      font-weight:600;
      transform:translateY(-2px);
    }
    .tab-icon.tab-active::after{
      opacity:1;
      transform:translateY(0);
    }
    .ok{color:#0f766e}
    .bad{color:#dc2626}
    .loading-overlay{
      position:fixed;
      inset:0;
      z-index:999;
      display:flex;
      align-items:center;
      justify-content:center;
      background:linear-gradient(160deg, rgba(2,6,23,0.92) 0%, rgba(15,23,42,0.92) 55%, rgba(30,41,59,0.94) 100%);
      backdrop-filter:blur(22px);
      transition:opacity .35s ease, visibility .35s ease;
    }
    .loading-overlay.loading-hidden{
      opacity:0;
      visibility:hidden;
      pointer-events:none;
    }
    .loading-panel{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:1rem;
      padding:2.5rem 3rem;
      border-radius:1.75rem;
      background:linear-gradient(145deg, rgba(30,41,59,0.88) 0%, rgba(15,23,42,0.9) 100%);
      border:1px solid rgba(148,163,184,0.25);
      box-shadow:0 35px 60px rgba(2,6,23,0.6);
      text-align:center;
    }
    .loading-spinner{
      position:relative;
      width:84px;
      height:84px;
    }
    .loading-spinner::before,
    .loading-spinner::after{
      content:"";
      position:absolute;
      inset:0;
      border-radius:50%;
      border:4px solid rgba(56,189,248,0.15);
    }
    .loading-spinner::after{
      border-top-color:#38bdf8;
      border-right-color:#38bdf8;
      border-bottom-color:transparent;
      border-left-color:transparent;
      animation:swirl 1.1s cubic-bezier(0.64, 0.04, 0.35, 1) infinite;
      box-shadow:0 0 24px rgba(56,189,248,0.45);
    }
    .loading-core{
      position:absolute;
      inset:24px;
      border-radius:50%;
      background:radial-gradient(circle at 30% 30%, rgba(56,189,248,0.9), rgba(14,165,233,0.45) 45%, rgba(14,165,233,0) 75%);
      filter:drop-shadow(0 0 12px rgba(56,189,248,0.65));
      animation:pulse 1.8s ease-in-out infinite;
    }
    .loading-message{
      font-size:1rem;
      max-width:18rem;
      line-height:1.6;
      letter-spacing:.04em;
      color:#e0f2fe;
      text-transform:uppercase;
      animation:message-glow 2.8s ease-in-out infinite;
    }
    @keyframes swirl{
      0%{transform:rotate(0deg)}
      100%{transform:rotate(360deg)}
    }
    @keyframes pulse{
      0%,100%{transform:scale(0.9);opacity:.65}
      50%{transform:scale(1);opacity:1}
    }
    @keyframes message-glow{
      0%,100%{opacity:0.65;filter:drop-shadow(0 0 0 rgba(56,189,248,0))}
      50%{opacity:1;filter:drop-shadow(0 0 14px rgba(56,189,248,0.6))}
    }
  </style>
</head>
<body class="antialiased">
  <div id="loading-overlay" class="loading-overlay" role="status" aria-live="polite" aria-busy="true">
    <div class="loading-panel">
      <div class="loading-spinner" aria-hidden="true">
        <span class="loading-core"></span>
      </div>
      <p class="loading-message" data-loading-message>Calibrating KPIs and charts — this stays up until every tile is live.</p>
    </div>
  </div>
  <header class="px-4 pt-6 pb-4">
    <div class="app-shell max-w-3xl mx-auto rounded-3xl px-6 py-4 flex flex-col gap-1 text-slate-100">
      <p class="text-xs uppercase tracking-[0.3em] text-sky-300/80">Energy Command Center</p>
      <h1 class="text-2xl font-semibold">Household Electricity & Solar</h1>
      <p class="text-sm text-slate-200/80">Monitor production, usage, and imports with a polished mobile hub.</p>
    </div>
  </header>

  <main id="view" class="px-4 pb-24 space-y-4">
    <!-- Tab content will be mounted here -->
  </main>

  <nav class="app-nav fixed bottom-0 left-0 right-0" style="padding-bottom:var(--safe-bottom)">
    <div class="grid grid-cols-5 items-center" role="tablist" aria-label="Primary">
      <button class="py-3 tab-icon tab-active" data-tab="kpi" role="tab" aria-selected="true" aria-controls="view">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><line x1="12" y1="20" x2="12" y2="10"/><line x1="18" y1="20" x2="18" y2="4"/><line x1="6" y1="20" x2="6" y2="16"/></svg>
        KPIs
      </button>
      <button class="py-3 tab-icon" data-tab="charts" role="tab" aria-selected="false" aria-controls="view">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M3 3v18h18"/><path d="M19 9l-5 5-4-4-3 3"/></svg>
        Charts
      </button>
      <button class="py-3 tab-icon" data-tab="record" role="tab" aria-selected="false" aria-controls="view">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="12" r="9"/><circle cx="12" cy="12" r="3"/></svg>
        Record
      </button>
      <button class="py-3 tab-icon" data-tab="data" role="tab" aria-selected="false" aria-controls="view">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="3" y1="15" x2="21" y2="15"/><line x1="9" y1="3" x2="9" y2="21"/><line x1="15" y1="3" x2="15" y2="21"/></svg>
        Data
      </button>
      <button class="py-3 tab-icon" data-tab="settings" role="tab" aria-selected="false" aria-controls="view">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9c0 .69.28 1.35.76 1.82.48.47 1.13.76 1.82.76H21a2 2 0 0 1 0 4h-.09c-.69 0-1.35.28-1.82.76-.48.47-.76 1.13-.76 1.82z"/></svg>
        Settings
      </button>
    </div>
  </nav>

  <script type="module" src="app.core.js"></script>
</body>
</html>
