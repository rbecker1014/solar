<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>TEST3</title>
    <style>
      body { font-family: system-ui, Arial, sans-serif; padding: 16px; }
      table { border-collapse: collapse; margin-top: 12px; }
      th, td { border: 1px solid #ccc; padding: 6px 8px; }
      th { background: #f6f6f6; }
      #status { margin-top: 12px; white-space: pre-wrap; }
    </style>
  </head>
  <body>
    <h3>TEST2</h3>
    <div id="status">Loadingâ€¦</div>
    <div id="results"></div>

    <script>
      const ENDPOINT = "https://script.google.com/macros/s/AKfycbwMS3F3h57llbmz0SQ59OPk6E-xunGw8W3bZ6PTJkJj7dA1T28hBNE_vfqYrjls0pVz/exec";

      function render(headers, rows) {
        const container = document.getElementById('results');
        if (!rows || rows.length === 0) {
          container.innerHTML = "<p>No data.</p>";
          return;
        }
        let thead = "<tr>" + headers.map(h => `<th>${h}</th>`).join("") + "</tr>";
        let tbody = rows.map(r => "<tr>" + r.map(v => `<td>${v}</td>`).join("") + "</tr>`).join("");
        container.innerHTML = `<table><thead>${thead}</thead><tbody>${tbody}</tbody></table>`;
      }

      (async () => {
        const status = document.getElementById('status');
        try {
          const res = await fetch(ENDPOINT, { method: "GET" });
          if (!res.ok) {
            status.textContent = `HTTP ${res.status} ${res.statusText}`;
            return;
          }
          const text = await res.text();
          try {
            const { headers, rows } = JSON.parse(text);
            status.textContent = "Done.";
            render(headers, rows);
          } catch (parseErr) {
            status.textContent = `Non-JSON response:\n\n${text}`;
          }
        } catch (err) {
          status.textContent = `Fetch error: ${err.message}`;
          console.error(err);
        }
      })();
    </script>
  </body>
</html>

